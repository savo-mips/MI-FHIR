<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>Dashboard</title>
</head>
<body>
  <button id="loadButton">Load data</button>
  <div id="result"></div>
</body>
<script>
    const fhir = 'https://hapi.fhir.org/baseR4';
    const patientId = 'example';

    //Voeg hier de LOINC-codes toe die je wil tonen
    const codesToFind = [
        '8867-4',
        '29463-7'
    ];

    async function loadObservations() {
        const resultDiv = document.getElementById('result');
        resultDiv.innerHTML = 'Loading...';

        try {
            const response = await fetch(`${fhir}/Observation?patient=${patientId}`);
            const data = await response.json();

            if (!data.entry || data.entry.length === 0) {
                resultDiv.textContent = 'No observations found.';
                return;
            }

            let output = '';
            for (const code of codesToFind) {
                const obs = data.entry.find(entry =>
                    entry.resource.code?.coding?.some(c => c.code === code)
                );

                if (obs) {
                    const resource = obs.resource;
                    const value = resource.valueQuantity?.value;
                    const unit = resource.valueQuantity?.unit;
                    const label = resource.code.coding[0].display
                    output += `${label}: ${value} ${unit}<br>`;
                } else {
                    output += `Observation for code ${code} not found.<br>`;
                }
            }
            resultDiv.innerHTML = output;

        } catch (err) {
            console.error(err);
            resultDiv.textContent = 'Error fetching data.';
        }
    }

    document.getElementById('loadButton').addEventListener('click', loadObservations);
</script>
</html>